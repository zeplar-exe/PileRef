<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:model="clr-namespace:PileRef.Model"
             xmlns:pileRef="clr-namespace:PileRef"
             xmlns:mdxaml="https://github.com/whistyun/Markdown.Avalonia"
             xmlns:controls="clr-namespace:AvaloniaMath.Controls;assembly=AvaloniaMath"
             xmlns:svg=":clr-namespace:Avalonia.Skia;assembly=Avalonia.Svg.Svg"
             xmlns:document="clr-namespace:PileRef.View.Document"
             xmlns:documents="clr-namespace:PileRef.Model.Document"
             x:Class="PileRef.View.DocumentView"
             Width="{Binding Document.Width}"
             Height="{Binding Document.Height}">
    <Grid RowDefinitions="Auto, *">
        <TextBox Grid.Row="0" x:Name="v_Title" 
                 IsReadOnly="{Binding !ViewModel.EditingTitle}" 
                 Focusable="{Binding ViewModel.EditingTitle}"
                 TextAlignment="Center" Text="{Binding Document.Title, Mode=TwoWay}"></TextBox>
        <ContentControl Grid.Row="1" 
                        Content="{Binding Document}" 
                        Background="White" BorderThickness="1" BorderBrush="Gray">
            <ContentControl.ContentTemplate>
                <pileRef:ObjectTemplateSelector>
                    <DataTemplate x:Key="{x:Type documents:MarkdownDocument}" DataType="documents:MarkdownDocument">
                        <mdxaml:MarkdownScrollViewer Cursor="IBeam" SelectionEnabled="True"
                                                     Markdown="{Binding Content}"/>
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:PlainTextDocument}" DataType="documents:PlainTextDocument">
                        <SelectableTextBlock Text="{Binding Content}"
                                             TextWrapping="Wrap"/>
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:LatexDocument}" DataType="documents:LatexDocument">
                        <controls:FormulaBlock Formula="{Binding Content}"/>
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:PilePdfDocument}" DataType="documents:PilePdfDocument">
                        <document:PdfDocumentView Document="{Binding}"/>
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:SvgDocument}" DataType="documents:SvgDocument">
                        <Image>
                            <Image.Source>
                                <SvgImage Source="{Binding Uri.Path}"></SvgImage>
                            </Image.Source>
                        </Image>
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:EpubDocument}" DataType="documents:EpubDocument">
                        
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:RichTextDocument}" DataType="documents:RichTextDocument">
                        
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:OdtDocument}" DataType="documents:OdtDocument">
                        
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:XpsDocument}" DataType="documents:XpsDocument">
                        
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:PagesDocument}" DataType="documents:PagesDocument">
                        
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:OldWordDocument}" DataType="documents:OldWordDocument">
                        
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:XmlWordDocument}" DataType="documents:XmlWordDocument">
                        
                    </DataTemplate>
                    <DataTemplate x:Key="{x:Type documents:ImageDocument}" DataType="documents:ImageDocument">
                        <Image Source="{Binding Image}"></Image>
                    </DataTemplate>
                </pileRef:ObjectTemplateSelector>
            </ContentControl.ContentTemplate>
        </ContentControl>
    </Grid>
</UserControl>
